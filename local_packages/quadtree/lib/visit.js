"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = _default;

var _quad = _interopRequireDefault(require("./quad.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _default(callback) {
  var quads = [],
      q,
      node = this._root,
      child,
      x0,
      y0,
      x1,
      y1;
  if (node) quads.push(new _quad["default"](node, this._x0, this._y0, this._x1, this._y1));

  while (q = quads.pop()) {
    if (!callback(node = q.node, x0 = q.x0, y0 = q.y0, x1 = q.x1, y1 = q.y1) && node.length) {
      var xm = (x0 + x1) / 2,
          ym = (y0 + y1) / 2;
      if (child = node[3]) quads.push(new _quad["default"](child, xm, ym, x1, y1));
      if (child = node[2]) quads.push(new _quad["default"](child, x0, ym, xm, y1));
      if (child = node[1]) quads.push(new _quad["default"](child, xm, y0, x1, ym));
      if (child = node[0]) quads.push(new _quad["default"](child, x0, y0, xm, ym));
    }
  }

  return this;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy92aXNpdC5qcyJdLCJuYW1lcyI6WyJjYWxsYmFjayIsInF1YWRzIiwicSIsIm5vZGUiLCJfcm9vdCIsImNoaWxkIiwieDAiLCJ5MCIsIngxIiwieTEiLCJwdXNoIiwiUXVhZCIsIl94MCIsIl95MCIsIl94MSIsIl95MSIsInBvcCIsImxlbmd0aCIsInhtIiwieW0iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7OztBQUVlLGtCQUFTQSxRQUFULEVBQW1CO0FBQ2hDLE1BQUlDLEtBQUssR0FBRyxFQUFaO0FBQUEsTUFBZ0JDLENBQWhCO0FBQUEsTUFBbUJDLElBQUksR0FBRyxLQUFLQyxLQUEvQjtBQUFBLE1BQXNDQyxLQUF0QztBQUFBLE1BQTZDQyxFQUE3QztBQUFBLE1BQWlEQyxFQUFqRDtBQUFBLE1BQXFEQyxFQUFyRDtBQUFBLE1BQXlEQyxFQUF6RDtBQUNBLE1BQUlOLElBQUosRUFBVUYsS0FBSyxDQUFDUyxJQUFOLENBQVcsSUFBSUMsZ0JBQUosQ0FBU1IsSUFBVCxFQUFlLEtBQUtTLEdBQXBCLEVBQXlCLEtBQUtDLEdBQTlCLEVBQW1DLEtBQUtDLEdBQXhDLEVBQTZDLEtBQUtDLEdBQWxELENBQVg7O0FBQ1YsU0FBT2IsQ0FBQyxHQUFHRCxLQUFLLENBQUNlLEdBQU4sRUFBWCxFQUF3QjtBQUN0QixRQUFJLENBQUNoQixRQUFRLENBQUNHLElBQUksR0FBR0QsQ0FBQyxDQUFDQyxJQUFWLEVBQWdCRyxFQUFFLEdBQUdKLENBQUMsQ0FBQ0ksRUFBdkIsRUFBMkJDLEVBQUUsR0FBR0wsQ0FBQyxDQUFDSyxFQUFsQyxFQUFzQ0MsRUFBRSxHQUFHTixDQUFDLENBQUNNLEVBQTdDLEVBQWlEQyxFQUFFLEdBQUdQLENBQUMsQ0FBQ08sRUFBeEQsQ0FBVCxJQUF3RU4sSUFBSSxDQUFDYyxNQUFqRixFQUF5RjtBQUN2RixVQUFJQyxFQUFFLEdBQUcsQ0FBQ1osRUFBRSxHQUFHRSxFQUFOLElBQVksQ0FBckI7QUFBQSxVQUF3QlcsRUFBRSxHQUFHLENBQUNaLEVBQUUsR0FBR0UsRUFBTixJQUFZLENBQXpDO0FBQ0EsVUFBSUosS0FBSyxHQUFHRixJQUFJLENBQUMsQ0FBRCxDQUFoQixFQUFxQkYsS0FBSyxDQUFDUyxJQUFOLENBQVcsSUFBSUMsZ0JBQUosQ0FBU04sS0FBVCxFQUFnQmEsRUFBaEIsRUFBb0JDLEVBQXBCLEVBQXdCWCxFQUF4QixFQUE0QkMsRUFBNUIsQ0FBWDtBQUNyQixVQUFJSixLQUFLLEdBQUdGLElBQUksQ0FBQyxDQUFELENBQWhCLEVBQXFCRixLQUFLLENBQUNTLElBQU4sQ0FBVyxJQUFJQyxnQkFBSixDQUFTTixLQUFULEVBQWdCQyxFQUFoQixFQUFvQmEsRUFBcEIsRUFBd0JELEVBQXhCLEVBQTRCVCxFQUE1QixDQUFYO0FBQ3JCLFVBQUlKLEtBQUssR0FBR0YsSUFBSSxDQUFDLENBQUQsQ0FBaEIsRUFBcUJGLEtBQUssQ0FBQ1MsSUFBTixDQUFXLElBQUlDLGdCQUFKLENBQVNOLEtBQVQsRUFBZ0JhLEVBQWhCLEVBQW9CWCxFQUFwQixFQUF3QkMsRUFBeEIsRUFBNEJXLEVBQTVCLENBQVg7QUFDckIsVUFBSWQsS0FBSyxHQUFHRixJQUFJLENBQUMsQ0FBRCxDQUFoQixFQUFxQkYsS0FBSyxDQUFDUyxJQUFOLENBQVcsSUFBSUMsZ0JBQUosQ0FBU04sS0FBVCxFQUFnQkMsRUFBaEIsRUFBb0JDLEVBQXBCLEVBQXdCVyxFQUF4QixFQUE0QkMsRUFBNUIsQ0FBWDtBQUN0QjtBQUNGOztBQUNELFNBQU8sSUFBUDtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFF1YWQgZnJvbSBcIi4vcXVhZC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihjYWxsYmFjaykge1xuICB2YXIgcXVhZHMgPSBbXSwgcSwgbm9kZSA9IHRoaXMuX3Jvb3QsIGNoaWxkLCB4MCwgeTAsIHgxLCB5MTtcbiAgaWYgKG5vZGUpIHF1YWRzLnB1c2gobmV3IFF1YWQobm9kZSwgdGhpcy5feDAsIHRoaXMuX3kwLCB0aGlzLl94MSwgdGhpcy5feTEpKTtcbiAgd2hpbGUgKHEgPSBxdWFkcy5wb3AoKSkge1xuICAgIGlmICghY2FsbGJhY2sobm9kZSA9IHEubm9kZSwgeDAgPSBxLngwLCB5MCA9IHEueTAsIHgxID0gcS54MSwgeTEgPSBxLnkxKSAmJiBub2RlLmxlbmd0aCkge1xuICAgICAgdmFyIHhtID0gKHgwICsgeDEpIC8gMiwgeW0gPSAoeTAgKyB5MSkgLyAyO1xuICAgICAgaWYgKGNoaWxkID0gbm9kZVszXSkgcXVhZHMucHVzaChuZXcgUXVhZChjaGlsZCwgeG0sIHltLCB4MSwgeTEpKTtcbiAgICAgIGlmIChjaGlsZCA9IG5vZGVbMl0pIHF1YWRzLnB1c2gobmV3IFF1YWQoY2hpbGQsIHgwLCB5bSwgeG0sIHkxKSk7XG4gICAgICBpZiAoY2hpbGQgPSBub2RlWzFdKSBxdWFkcy5wdXNoKG5ldyBRdWFkKGNoaWxkLCB4bSwgeTAsIHgxLCB5bSkpO1xuICAgICAgaWYgKGNoaWxkID0gbm9kZVswXSkgcXVhZHMucHVzaChuZXcgUXVhZChjaGlsZCwgeDAsIHkwLCB4bSwgeW0pKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRoaXM7XG59XG4iXX0=